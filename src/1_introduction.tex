\chapter{序論}
\label{introduction}

本研究では、惑星規模の分散システムのためのステージング環境の設計と構築を行う。

本章では、まず初めに惑星規模の分散システムを定義し、本研究の背景である惑星規模の分散システムの発達とシステムのステージング環境について概説する。
次に、本研究の課題を明らかにした上で、目的を明確化し、目的を達するための仮説を示す。
最後に仮説を裏付けるための提案手法を示し、本研究の概要を示す。

\section{本研究の背景}
\label{introduction:background}

本節では、本研究の背景について述べる。

まず初めに、本研究が対象とする惑星規模の分散システムとステージング環境について概説する。
惑星規模の分散システムの定義にあたって、比較しやすくするため、別のシステムモデルであるモノリスと分散システムについても述べる。
次に、惑星規模の分散システムの発達について述べ、その後に惑星規模の分散システムに求められるステージング環境について説明する。

\subsection{惑星規模の分散システム}

本研究における惑星規模の分散システムを定義する前に、惑星規模の分散システムとは別のシステムモデルであるモノリスと分散システムについて概説する。

まず、モノリスとはモノシリックなシステムを指し、本研究では単一のコンポーネントで構成されるシステムと認識する。

次に、分散システムはモノリスとは対称的に複数のコンポーネントが組み合わさって動作するシステムである。
分散システムでは、複数の独立したコンポーネントが協調動作することによってシステム全体が成り立っている。

最後に、惑星規模の分散システムは、分散システムの中でも世界中に地理的に分散したコンピュータによって構成されるものを指す。
システム全体が特定の箇所に収まらず、世界中のあらゆる箇所のコンピュータが協調動作することによってシステム全体が機能する点が特徴的である。
具体的には、ブロックチェーン~\cite{Bitcoin}が惑星規模の分散システムに属する。
惑星規模の分散システムを支える技術としては、P2Pが挙げられる。
P2Pは``Peer to Peer''の略であり、コンピュータ同士が対等な関係を築き協調動作する、中央集権的なサーバを必要としないシステムモデルである。
クライアントサーバモデルのシステムのように、システム内に明確な役割分担と主従関係のあるシステムとは対照的である。
クライアントサーバモデルでは，通信において常にクライアント対サーバで一対一の関係が成り立つ．
クライアントはサーバに対してリクエストを送り，リクエストを受け取ったサーバは特定の処理に基づいてクライアントに対しレスポンスを返す．
対してブロックチェーンのようなP2Pのシステムでは，参加するコンピュータの役割は状況に応じて柔軟に変化する．
時にクライアントとして他のコンピュータに対して要求し，時に他のコンピュータからの要求に対して応答する．
クライアントサーバモデルに比べて，耐障害性・冗長性・可用性において優れているのが特徴的である．

\subsection{惑星規模の分散システムの発達}

2000年代初頭，Winny~\cite{Winny}やGnutellaといった惑星規模の分散システムが頭角を現した．
どちらのサービスもP2P技術を基盤としており、それまでシステムモデルとして一般的であったクライアントサーバモデルとは異なる形態を採用したことで注目が集まった。
P2P技術が研究分野で取り上げられる頻度も多くなり、サービスとしても今後一層幅を広げていくと思われたが、クライアントサーバモデルに置き換わるまでの隆盛はなく後退していった．
しかし，2008年にSatoshi NakamotoによりBitcoinのために開発されたブロックチェーン技術が登場することによって，再度P2P技術が脚光を浴びるようになり，開発や研究の勢いが再び盛んになってきている．

\subsection{ステージング環境}

ステージング環境とは，本番環境での運用をする前に実際の環境を想定してシステム全体のテストを行うための環境である．
開発者が実際に開発を行う開発環境と実運用する本番環境では，環境の差異から動作の違いが生じ，手元で正常に動作していたものが本番環境に反映した途端動作しなくなるといった事象が度々発生する．
そのような事態を防ぐために開発環境と本番環境の間に，本番環境を想定したステージング環境を構築し，本番環境へのデプロイ前にステージング環境にて動作を確認することで予想外の障害が発生するリスクを抑えることができる．
惑星規模の分散システムにおいても、実運用での不具合や軽微なバグを早期に発見するためにステージング環境が必要である。
モノリスの場合、システムは単一のコンポーネントで構成され、システムを構成するサーバの配置は開発者が任意に決定できる。
よって、本番環境と同じ構成をオンプレ環境もしくはクラウド環境を用いて構築し、システムに対して任意の入力をした際に期待する動作がされるかどうかを確認すればよい。
一方、分散システムの場合もモノリスと同じくサーバの配置は開発者が指定できるため、ステージング環境の構築は比較的容易である。
しかし、分散システムは複数のコンポーネントから構成されるため、各コンポーネントのテストに加え、すべてのコンポーネントを通したシステム全体でのテストを行う必要がある。
最後に、惑星規模の分散システムのテストはモノリスや分散システムに比べて難易度が高くなる。
何故なら、惑星規模の分散システムにおいて、システムを構成するコンピュータは世界中に地理的に分散しており、開発者がシステム全体の構成を固定できないからである。
システムには世界中の至る場所からコンピュータが参加し、システム全体も常にスケーリングする可能性がある。
惑星規模の分散システムのステージング環境の構築をする場合、地理的な場所を指定し分散させてサーバを配置する必要がある。

\section{本研究の課題と目的}

\subsection{本研究の課題}
\label{introduction:issue-and-aim:issue}

本研究では，地理的に分散したシステムのためのステージング環境の構築と運用において解決すべき課題があると考えた．

通常，ステージング環境では必要となるサーバの設置，アプリケーションのデプロイ，修正を含んだパッチの適用などの多くの変更が行われる．
AWS~\cite{AWS}やGCP~\cite{GCP},Azure~\cite{Azure}と行ったクラウドサービスや開発支援ツールが整った昨今，これらの殆どが自動化され開発者はサービス開発のみに集中できるようになった．

しかし，地理的に分散したシステムにおいてはこれらの恩恵を得られていない．
クラウドサービスでは固定のゾーンが存在するためサーバの地理的な位置を自由に決定することができず，遠距離間でサーバを一斉にコントロールすることも難しい．
結果的に，地理的に分散したシステムのためのステージング環境の構築と運用では，各地点のサーバ管理者による情報共有と個別の作業が必要になる．

つまり，各地点でのサーバの設置から不定期で頻繁に発生するアップデート作業まで全てにおいて，コミュニケーションコストの増大，
作業時間と労力の消費，人為的ミス等の不安要素の発生といった課題点が予想される．

\subsection{本研究の目的}
\label{introduction:issue-and-aim:aim}

本研究では，地理的に分散したシステムのためのステージング環境の構築手法を提案することを目的とする．

\section{本研究の仮説}
\label{introduction:hypothesis}

~\ref{introduction:issue-and-aim:issue}で述べた課題を解決するためには，地理的に分散したサーバを統合管理することで，
ステージング環境での変更に対し柔軟かつ迅速に対応する必要があると考えた．

地理的に分散したサーバを統合管理するためには，
\begin{itemize}
  \item ステージング環境に含まれるサーバ同士が，お互いに通信可能な状態であること
  \item ある特定の地点から全てのサーバに対して操作が可能であること
\end{itemize}
の二点を満たさなければならない．

本研究では，上記の必要要件を満たすことで~\ref{introduction:issue-and-aim:issue}で述べた課題点を解決し，
~\ref{introduction:issue-and-aim:aim}で述べた地理的に分散したシステムのためのステージング環境の構築手法の提案を達成できると考えた．

\section{本研究の手法}
\label{introduction:proposal}

本研究では，~\ref{introduction:hypothesis}で述べた必要要件を満たすため，OpenVPNとKubernetesを用いる．

まず，Kubernetesはコンテナオーケストレーションツールであり，コンテナ化されたアプリケーションのデプロイやスケーリングを自動化し，
統合管理するためのシステムである．
Kubernetesでは複数のサーバでクラスタを構成しており，クラスタ化には各サーバがお互いにIPレベルで疎通可能な状態になければならない．
よって，Kubernetesは単一のデータセンター内での使用に適している一方，複数のデータセンターを跨がった構成での使用には適していない．

そこで，地理的に分散したサーバ間を結ぶOpenVPNオーバーレイネットワークを構築することで，各サーバがお互いにIP Reachableな状態にする．
OpenVPNとは，VPNネットワークの構築をソフトウェアで実現するために開発されたオープンソースソフトウェアである．

本研究では，OpenVPNとKubernetesを組み合わせ，地理的に分散したノード間で形成したOpenVPNオーバーレイネットワーク上でKubernetesクラスタを
構築した．
別々のセグメントに位置するノードを用いてKubernetesクラスタを構築し，コンテナ化したアプリケーションをクラスタ上にデプロイできていることを確認し，
本システムの課題点を解決できているか推定することで要件を満たせることを確認した．

\section{本論文の構成}
\label{introduction:structure}

本論文における以降の構成は次の通りである．

~\ref{background}章では，地理的に分散したシステムとその実験的運用方法およびそれに伴う課題点について議論し，本研究の背景を明確化する．
~\ref{issue}章では，本研究で着目する問題を解決するための要件，仮説と手法について説明する．
~\ref{implementation}章では，~\ref{proposed}章で述べた提案手法について述べる．
~\ref{evaluation}章では，\ref{background}章で求められた課題に対しての評価を行い，考察する．
~\ref{conclusion}章では，本研究のまとめと今後の課題についてまとめる．

%%% Local Variables:
%%% mode: japanese-latex
%%% TeX-master: "../thesis"
%%% End:
